<h1 class="mb-4">Dashboard</h1>

<div class="row mb-4">
  <div class="col-md-4">
    <div class="card shadow-sm p-3">
      <h5>Total de ingressos vendidos</h5>
      <p class="display-6"><%= @total_tickets_sold %></p>
    </div>
  </div>

  <div class="col-md-4">
    <div class="card shadow-sm p-3">
      <h5>Total arrecadado</h5>
      <p class="display-6">R$ <%= number_with_precision(@total_revenue, precision: 2) %></p>
    </div>
  </div>

  <div class="col-md-4">
    <div class="card shadow-sm p-3 text-center d-flex justify-content-center align-items-center">
      <%= link_to "Criar novo evento", new_event_path, class: "btn btn-primary btn-lg" %>
    </div>
  </div>
</div>

<hr class="my-4">

<h3>Meus Eventos</h3>

<% if @events.any? %>
  <div class="row">
    <% @events.each do |event| %>
      <div class="col-md-6 mb-4">
        <div class="card p-3 shadow-sm">

          <% if event.image.attached? %>
            <%= image_tag event.image, class: "img-fluid rounded mb-3", style: "height: 200px; object-fit: cover;" %>
          <% end %>

          <h4><%= event.name %></h4>
          <p class="text-muted"><%= event.date.strftime("%d/%m/%Y %H:%M") %></p>

          <p>
            Ingressos vendidos: <strong><%= event.tickets_sold %></strong><br>
            Arrecadado: <strong>R$ <%= number_with_precision(event.revenue, precision: 2) %></strong><br>
            Restam: <strong><%= event.tickets_available %></strong> ingressos
          </p>

          <div class="d-flex gap-2">
            <%= link_to "Editar", edit_event_path(event), class: "btn btn-sm btn-warning" %>

            <%= link_to "Excluir",
                        event_path(event),
                        method: :delete,
                        data: { confirm: "Tem certeza que deseja excluir este evento?" },
                        class: "btn btn-sm btn-danger" %>
          </div>

        </div>
      </div>
    <% end %>
  </div>

<% else %>
  <p>Você ainda não criou nenhum evento.</p>
<% end %>
